<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">test.java</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">main.java.Catena</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">main.java.Catena.POWstruct</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">main.java.DefaultInstances</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">main.java.Helper</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CatenaTest</span> <span class="p">{</span>
	
	<span class="n">Helper</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Helper</span><span class="p">();</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathHInit</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/hInitAnyFull.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileHInit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathHInit</span><span class="p">);</span>
	
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathtweakButterfly</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/tweakButterfly.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filetweakButterfly</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathtweakButterfly</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathtweakButterflyFull</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/tweakButterflyFull.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filetweakButterflyFull</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathtweakButterflyFull</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathtweakDragonfly</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/tweakDragonfly.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filetweakDragonfly</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathtweakDragonfly</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathtweakDragonflyFull</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/tweakDragonflyFull.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filetweakDragonflyFull</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathtweakDragonflyFull</span><span class="p">);</span>
	
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathFlapDragonfly</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/flapDragonfly.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileFlapDragonfly</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathFlapDragonfly</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathFlapDragonflyFull</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/flapDragonflyFull.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileFlapDragonflyFull</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathFlapDragonflyFull</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathFlapButterfly</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/flapButterfly.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileFlapButterfly</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathFlapButterfly</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathFlapButterflyFull</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/flapButterflyFull.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileFlapButterflyFull</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathFlapButterflyFull</span><span class="p">);</span>
	
	
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathciUpdateDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/ciUpdateDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileciUpdateDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathciUpdateDragonflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathciUpdateKeyedDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/ciUpdateKeyedDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileciUpdateKeyedDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathciUpdateKeyedDragonflyReduced</span><span class="p">);</span>
	
<span class="c1">//	private String pathkeyDerivationButterfly = &quot;src/test/resources/keyDerivationButterfly.json&quot;;</span>
<span class="c1">//	private File filekeyDerivationButterfly = new File(pathkeyDerivationButterfly);</span>
<span class="c1">//</span>
<span class="c1">//	private String pathkeyDerivationButterflyFull = &quot;src/test/resources/keyDerivationButterflyFull.json&quot;;</span>
<span class="c1">//	private File filekeyDerivationButterflyFull = new File(pathkeyDerivationButterflyFull);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathkeyDerivationButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/keyDerivationButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filekeyDerivationButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathkeyDerivationButterflyReduced</span><span class="p">);</span>
	
<span class="c1">//	private String pathkeyDerivationDragonfly = &quot;src/test/resources/keyDerivationDragonfly.json&quot;;</span>
<span class="c1">//	private File filekeyDerivationDragonfly = new File(pathkeyDerivationDragonfly);</span>
<span class="c1">//	</span>
<span class="c1">//	private String pathkeyDerivationDragonflyFull = &quot;src/test/resources/keyDerivationDragonflyFull.json&quot;;</span>
<span class="c1">//	private File filekeyDerivationDragonflyFull = new File(pathkeyDerivationDragonflyFull);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathkeyDerivationDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/keyDerivationDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filekeyDerivationDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathkeyDerivationDragonflyReduced</span><span class="p">);</span>
	
<span class="c1">//	private String pathkeyedHashButterfly = &quot;src/test/resources/keyedHashButterfly.json&quot;;</span>
<span class="c1">//	private File filekeyedHashButterfly = new File(pathkeyedHashButterfly);</span>
<span class="c1">//	</span>
<span class="c1">//	private String pathkeyedHashButterflyFull = &quot;src/test/resources/keyedHashButterflyFull.json&quot;;</span>
<span class="c1">//	private File filekeyedHashButterflyFull = new File(pathkeyedHashButterflyFull);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathkeyedHashButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/keyedHashButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filekeyedHashButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathkeyedHashButterflyReduced</span><span class="p">);</span>
	
<span class="c1">//	private String pathkeyedHashDragonfly = &quot;src/test/resources/keyedHashDragonfly.json&quot;;</span>
<span class="c1">//	private File filekeyedHashDragonfly = new File(pathkeyedHashDragonfly);</span>
<span class="c1">//	</span>
<span class="c1">//	private String pathkeyedHashDragonflyFull = &quot;src/test/resources/keyedHashDragonflyFull.json&quot;;</span>
<span class="c1">//	private File filekeyedHashDragonflyFull = new File(pathkeyedHashDragonflyFull);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathkeyedHashDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/keyedHashDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">filekeyedHashDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathkeyedHashDragonflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathserverReliefClientButterflyReducedDifferentG</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/serverReliefClientButterflyReducedDifferentG.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileserverReliefClientButterflyReducedDifferentG</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathserverReliefClientButterflyReducedDifferentG</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathserverReliefClientButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/serverReliefClientButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileserverReliefClientButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathserverReliefClientButterflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathserverReliefClientDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/serverReliefClientDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileserverReliefClientDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathserverReliefClientDragonflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathserverReliefServerButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/serverReliefServerButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileserverReliefServerButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathserverReliefServerButterflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathserverReliefServerDragonflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/serverReliefServerDragonflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileserverReliefServerDragonflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathserverReliefServerDragonflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathproofOfWorkServerSaltButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/proofOfWorkServerSaltButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileproofOfWorkServerSaltButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathproofOfWorkServerSaltButterflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathproofOfWorkServerPwdButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/proofOfWorkServerPwdButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileproofOfWorkServerPwdButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathproofOfWorkServerPwdButterflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathproofOfWorkClientPwdButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/proofOfWorkClientPwdButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileproofOfWorkClientPwdButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathproofOfWorkClientPwdButterflyReduced</span><span class="p">);</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">pathproofOfWorkClientSaltButterflyReduced</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/proofOfWorkClientSaltButterflyReduced.json&quot;</span><span class="p">;</span>
	<span class="kd">private</span> <span class="n">File</span> <span class="n">fileproofOfWorkClientSaltButterflyReduced</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">pathproofOfWorkClientSaltButterflyReduced</span><span class="p">);</span>
	
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServerReliefServerButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileserverReliefServerButterflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;hash&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">hashArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">hash</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">serverReliefServer</span><span class="p">(</span><span class="n">outputLength</span><span class="p">,</span> <span class="n">hashArr</span><span class="p">);</span>
			
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">());</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServerReliefServerDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileserverReliefServerDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;hash&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">hashArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">hash</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">serverReliefServer</span><span class="p">(</span><span class="n">outputLength</span><span class="p">,</span> <span class="n">hashArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServerReliefClientButterflyReduceddifferentG</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileserverReliefClientButterflyReducedDifferentG</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">gLow</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;gLow&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">gHigh</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;gHigh&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="n">gLow</span><span class="p">);</span>
			<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="n">gHigh</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">serverReliefClient</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServerReliefClientButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileserverReliefClientButterflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">serverReliefClient</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServerReliefClientDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileserverReliefClientDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">serverReliefClient</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	

<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyedHashButterfly(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initButterfly();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyedHashButterfly);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String key = inputs.getString(&quot;key&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;aData&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;outputLength&quot;);</span>
<span class="c1">//			String userID = inputs.getString(&quot;userID&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] keyArr = helper.hex2bytes(key);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] userIDArr = helper.hex2bytes(userID);</span>
<span class="c1">//			</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyedPasswordHashing(pwdArr, keyArr, saltArr, gammaArr, adArr, outputLength, userIDArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>

	
<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyedHashButterflyFull(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initButterflyFull();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyedHashButterflyFull);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String key = inputs.getString(&quot;key&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;aData&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;outputLength&quot;);</span>
<span class="c1">//			String userID = inputs.getString(&quot;userID&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] keyArr = helper.hex2bytes(key);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] userIDArr = helper.hex2bytes(userID);</span>
<span class="c1">//			</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyedPasswordHashing(pwdArr, keyArr, saltArr, gammaArr, adArr, outputLength, userIDArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testKeyedHashButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filekeyedHashButterflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">userID</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;userID&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">keyArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">userIDArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">userID</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">keyedPasswordHashing</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">keyArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">userIDArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyedHashDragonfly(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initDragonfly();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyedHashDragonfly);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String key = inputs.getString(&quot;key&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;aData&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;outputLength&quot;);</span>
<span class="c1">//			String userID = inputs.getString(&quot;userID&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] keyArr = helper.hex2bytes(key);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] userIDArr = helper.hex2bytes(userID);</span>
<span class="c1">//			</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyedPasswordHashing(pwdArr, keyArr, saltArr, gammaArr, adArr, outputLength, userIDArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>
	
<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyedHashDragonflyFull(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initDragonflyFull();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyedHashDragonflyFull);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String key = inputs.getString(&quot;key&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;aData&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;outputLength&quot;);</span>
<span class="c1">//			String userID = inputs.getString(&quot;userID&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] keyArr = helper.hex2bytes(key);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] userIDArr = helper.hex2bytes(userID);</span>
<span class="c1">//			</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyedPasswordHashing(pwdArr, keyArr, saltArr, gammaArr, adArr, outputLength, userIDArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>

	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testKeyedHashDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filekeyedHashDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outputLength&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">userID</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;userID&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">keyArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">userIDArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">userID</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">keyedPasswordHashing</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">keyArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">userIDArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	

<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyDerivationButterfly(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initButterfly();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyDerivationButterfly);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;ad&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String keyIdentifier = inputs.getString(&quot;key_identifier&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;output_length&quot;);</span>
<span class="c1">//			int keySize = inputs.getInt(&quot;key_size&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] keyIdentifierArr = helper.hex2bytes(keyIdentifier);</span>
<span class="c1">//</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyDerivation(pwdArr, saltArr, adArr, gammaArr, outputLength, keySize, keyIdentifierArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>
<span class="c1">//	</span>


<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyDerivationButterflyFull(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initButterflyFull();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyDerivationButterflyFull);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;ad&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String keyIdentifier = inputs.getString(&quot;key_identifier&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;output_length&quot;);</span>
<span class="c1">//			int keySize = inputs.getInt(&quot;key_size&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] keyIdentifierArr = helper.hex2bytes(keyIdentifier);</span>
<span class="c1">//</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyDerivation(pwdArr, saltArr, adArr, gammaArr, outputLength, keySize, keyIdentifierArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testKeyDerivationButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filekeyDerivationButterflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;ad&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">keyIdentifier</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;key_identifier&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;output_length&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">keySize</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;key_size&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">keyIdentifierArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">keyIdentifier</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">keyDerivation</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">keySize</span><span class="p">,</span> <span class="n">keyIdentifierArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	
<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyDerivationDragonfly(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initDragonfly();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyDerivationDragonfly);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;ad&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String keyIdentifier = inputs.getString(&quot;key_identifier&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;output_length&quot;);</span>
<span class="c1">//			int keySize = inputs.getInt(&quot;key_size&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] keyIdentifierArr = helper.hex2bytes(keyIdentifier);</span>
<span class="c1">//</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyDerivation(pwdArr, saltArr, adArr, gammaArr, outputLength, keySize, keyIdentifierArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>
<span class="c1">//	</span>
<span class="c1">//	@Test</span>
<span class="c1">//	public void testKeyDerivationDragonflyFull(){</span>
<span class="c1">//		DefaultInstances instance = new DefaultInstances();</span>
<span class="c1">//		Catena c = instance.initDragonflyFull();</span>
<span class="c1">//		</span>
<span class="c1">//		JSONArray jsonObj = helper.jsonParserArr(filekeyDerivationDragonflyFull);</span>
<span class="c1">//		for (int i = 0; i&lt;jsonObj.length(); ++i ){</span>
<span class="c1">//			JSONObject o = (JSONObject) jsonObj.get(i);</span>
<span class="c1">//			</span>
<span class="c1">//			JSONObject inputs = o.getJSONObject(&quot;inputs&quot;);</span>
<span class="c1">//			JSONObject outputs = o.getJSONObject(&quot;outputs&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			String pwd = inputs.getString(&quot;pwd&quot;);</span>
<span class="c1">//			String ad = inputs.getString(&quot;ad&quot;);</span>
<span class="c1">//			String salt = inputs.getString(&quot;salt&quot;);</span>
<span class="c1">//			String gamma = inputs.getString(&quot;gamma&quot;);</span>
<span class="c1">//			String keyIdentifier = inputs.getString(&quot;key_identifier&quot;);</span>
<span class="c1">//			int outputLength = inputs.getInt(&quot;output_length&quot;);</span>
<span class="c1">//			int keySize = inputs.getInt(&quot;key_size&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] pwdArr = helper.hex2bytes(pwd);</span>
<span class="c1">//			byte[] adArr = helper.hex2bytes(ad);</span>
<span class="c1">//			byte[] saltArr = helper.hex2bytes(salt);</span>
<span class="c1">//			byte[] gammaArr = helper.hex2bytes(gamma);</span>
<span class="c1">//			byte[] keyIdentifierArr = helper.hex2bytes(keyIdentifier);</span>
<span class="c1">//</span>
<span class="c1">//			String res = outputs.getString(&quot;res&quot;);</span>
<span class="c1">//			</span>
<span class="c1">//			byte[] output = c.keyDerivation(pwdArr, saltArr, adArr, gammaArr, outputLength, keySize, keyIdentifierArr);</span>
<span class="c1">//			</span>
<span class="c1">//			assertTrue(res.equals(helper.bytes2hex(output).toLowerCase()));</span>
<span class="c1">//		}</span>
<span class="c1">//	}</span>

	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testKeyDerivationDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filekeyDerivationDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">ad</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;ad&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">keyIdentifier</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;key_identifier&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outputLength</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;output_length&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">keySize</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;key_size&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">adArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">ad</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">keyIdentifierArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">keyIdentifier</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">keyDerivation</span><span class="p">(</span><span class="n">pwdArr</span><span class="p">,</span> <span class="n">saltArr</span><span class="p">,</span> <span class="n">adArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">outputLength</span><span class="p">,</span> <span class="n">keySize</span><span class="p">,</span> <span class="n">keyIdentifierArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCIUpdateDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="kt">int</span> <span class="n">gOld</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="n">gOld</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="n">gOld</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileciUpdateDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">oldHash</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;oldHash&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">gNew</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;gNew&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">oldHashArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">oldHash</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
			<span class="k">try</span> <span class="p">{</span>
				<span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">clientIndependentUpdate</span><span class="p">(</span><span class="n">oldHashArr</span><span class="p">,</span> <span class="n">gOld</span><span class="p">,</span> <span class="n">gNew</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">outLen</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not update Hash.&quot;</span><span class="p">);</span>
				<span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
			<span class="p">}</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCIUpdateKeyedDragonflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="kt">int</span> <span class="n">gOld</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="n">gOld</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="n">gOld</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileciUpdateKeyedDragonflyReduced</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">oldHash</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;oldHash&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">gNew</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;gNew&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">userID</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;userID&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">oldHashArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">oldHash</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">keyArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">userIDArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">userID</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
			<span class="k">try</span> <span class="p">{</span>
				<span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">keyedClientIndependentUpdate</span><span class="p">(</span><span class="n">oldHashArr</span><span class="p">,</span> <span class="n">gOld</span><span class="p">,</span> <span class="n">gNew</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">,</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">keyArr</span><span class="p">,</span> <span class="n">userIDArr</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not update Hash.&quot;</span><span class="p">);</span>
				<span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
			<span class="p">}</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFlapButterfly</span><span class="p">(){</span>
		
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileFlapButterfly</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">flapPub</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pwdArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFlapButterflyFull</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initButterflyFull</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileFlapButterflyFull</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">flapPub</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pwdArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFlapDragonfly</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileFlapDragonfly</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
			
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">flapPub</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pwdArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFlapDragonflyFull</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonflyFull</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileFlapDragonflyFull</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaArr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">flapPub</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pwdArr</span><span class="p">,</span> <span class="n">gammaArr</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTweakButterfly</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filetweakButterfly</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">domain</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">sLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;sLen&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">aD</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">string2Bytes</span><span class="p">(</span><span class="n">aD</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">testCompTweak</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">getVID</span><span class="p">(),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="na">getLambda</span><span class="p">(),</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">sLen</span><span class="p">,</span> <span class="n">aData</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTweakButterflyFull</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initButterflyFull</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filetweakButterflyFull</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">domain</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">sLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;sLen&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">aD</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">string2Bytes</span><span class="p">(</span><span class="n">aD</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">testCompTweak</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">getVID</span><span class="p">(),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="na">getLambda</span><span class="p">(),</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">sLen</span><span class="p">,</span> <span class="n">aData</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTweakDragonfly</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonfly</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filetweakDragonfly</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">domain</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">sLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;sLen&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">aD</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">string2Bytes</span><span class="p">(</span><span class="n">aD</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">testCompTweak</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">getVID</span><span class="p">(),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="na">getLambda</span><span class="p">(),</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">sLen</span><span class="p">,</span> <span class="n">aData</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTweakDragonflyFull</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonflyFull</span><span class="p">();</span>
	
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">filetweakDragonflyFull</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>
			
			<span class="kt">int</span> <span class="n">domain</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">sLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;sLen&quot;</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">aD</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">string2Bytes</span><span class="p">(</span><span class="n">aD</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">testCompTweak</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">getVID</span><span class="p">(),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="na">getLambda</span><span class="p">(),</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">sLen</span><span class="p">,</span> <span class="n">aData</span><span class="p">);</span>
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">output</span><span class="p">).</span><span class="na">toLowerCase</span><span class="p">()));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testHInit</span><span class="p">(){</span>
		
		<span class="n">DefaultInstances</span> <span class="n">defaultInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">defaultInstance</span><span class="p">.</span><span class="na">initDragonflyFull</span><span class="p">();</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileHInit</span><span class="p">);</span>
		
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span>  <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>

			<span class="n">String</span> <span class="n">x</span> 	  <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">xArray</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
			
			<span class="n">JSONArray</span> <span class="n">out</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getJSONArray</span><span class="p">(</span><span class="s">&quot;v&quot;</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">out</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
			<span class="n">String</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">out</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">testHInit</span><span class="p">(</span><span class="n">xArray</span><span class="p">);</span>
			
			<span class="n">String</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v0</span><span class="o">+</span><span class="n">v1</span><span class="p">;</span>
			
			
			<span class="n">assertTrue</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">helper</span><span class="p">.</span><span class="na">bytes2hex</span><span class="p">(</span><span class="n">result</span><span class="p">)));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testProofOfWorkServerSaltButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileproofOfWorkServerSaltButterflyReduced</span><span class="p">);</span>
		
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span>  <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>

			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aDataExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLenExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">outHashExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;outHash&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">pExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">modeExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			
			<span class="n">POWstruct</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">proofOfWorkServer</span><span class="p">(</span><span class="n">pwd</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">aData</span><span class="p">,</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
			
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">pwdExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">pwd</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">saltExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">salt</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">aDataExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">aData</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">gammaExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">gamma</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">outHashExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">rHash</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">outLenExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">outLen</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">pExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">p</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">modeExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">mode</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testProofOfWorkServerPwdButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileproofOfWorkServerPwdButterflyReduced</span><span class="p">);</span>
		
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span>  <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>

			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwdExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">saltExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aDataExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gammaExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLenExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">outHashExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;outHash&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">pExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">modeExp</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			
			<span class="n">POWstruct</span> <span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">proofOfWorkServer</span><span class="p">(</span><span class="n">pwd</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">aData</span><span class="p">,</span> <span class="n">outLen</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
			
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">pwdExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">pwd</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">saltExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">salt</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">aDataExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">aData</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">gammaExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">gamma</span><span class="p">);</span>
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">outHashExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">rHash</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">outLenExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">outLen</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">pExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">p</span><span class="p">);</span>
			<span class="n">assertEquals</span><span class="p">(</span><span class="n">modeExp</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="na">mode</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testProofOfWorkClientPwdButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileproofOfWorkClientPwdButterflyReduced</span><span class="p">);</span>
		
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span>  <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>

			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;hash&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">resExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">));</span>
			
			<span class="n">POWstruct</span> <span class="n">input</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">new</span> <span class="nf">POWstruct</span><span class="p">();</span>
			<span class="n">input</span><span class="p">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">salt</span> <span class="o">=</span> <span class="n">salt</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">aData</span> <span class="o">=</span> <span class="n">aData</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">gamma</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">outLen</span> <span class="o">=</span> <span class="n">outLen</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">rHash</span> <span class="o">=</span> <span class="n">hash</span><span class="p">;</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">actuals</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">proofOfWorkClient</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
			
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">resExp</span><span class="p">,</span> <span class="n">actuals</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testProofOfWorkClientSaltButterflyReduced</span><span class="p">(){</span>
		<span class="n">DefaultInstances</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultInstances</span><span class="p">();</span>
		<span class="n">Catena</span> <span class="n">c</span> <span class="o">=</span> <span class="n">instance</span><span class="p">.</span><span class="na">initButterfly</span><span class="p">();</span>
		
		<span class="n">c</span><span class="p">.</span><span class="na">setGHigh</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		<span class="n">c</span><span class="p">.</span><span class="na">setGLow</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
		
		<span class="n">JSONArray</span> <span class="n">jsonObj</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">jsonParserArr</span><span class="p">(</span><span class="n">fileproofOfWorkClientSaltButterflyReduced</span><span class="p">);</span>
		
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">jsonObj</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span> <span class="p">){</span>
			<span class="n">JSONObject</span> <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
			
			<span class="n">JSONObject</span> <span class="n">inputs</span>  <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;inputs&quot;</span><span class="p">);</span>
			<span class="n">JSONObject</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&quot;outputs&quot;</span><span class="p">);</span>

			<span class="kt">byte</span><span class="o">[]</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;pwd&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;salt&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">aData</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;aData&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">));</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;hash&quot;</span><span class="p">));</span>
			<span class="kt">int</span> <span class="n">outLen</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;outLen&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">);</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">resExp</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">hex2bytes</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;res&quot;</span><span class="p">));</span>
			
			<span class="n">POWstruct</span> <span class="n">input</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">new</span> <span class="nf">POWstruct</span><span class="p">();</span>
			<span class="n">input</span><span class="p">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">salt</span> <span class="o">=</span> <span class="n">salt</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">aData</span> <span class="o">=</span> <span class="n">aData</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">gamma</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">outLen</span> <span class="o">=</span> <span class="n">outLen</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">;</span>
			<span class="n">input</span><span class="p">.</span><span class="na">rHash</span> <span class="o">=</span> <span class="n">hash</span><span class="p">;</span>
			
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">actuals</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="na">proofOfWorkClient</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
			
			<span class="n">assertArrayEquals</span><span class="p">(</span><span class="n">resExp</span><span class="p">,</span> <span class="n">actuals</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
<span class="p">}</span>
</pre></div>
