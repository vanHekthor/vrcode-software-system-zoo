<div class="highlight"><pre><span></span><span class="gh"># Catena Test Vectors</span>

This are test vectors for Catena implementations.

Every test vector is an array of tests
cases, each containing the inputs for the function in <span class="sb">`inputs`</span> and the
expected outputs in <span class="sb">`outputs`</span>.
Strings in these files have to be interpreted as hex encoded big endian byte
strings with two characters for a byte unless stated otherwise.

Each file uses up to one Catena instance for every contained test case, which is
specified in the file name. These instances are:

<span class="k">-</span> <span class="sb">`Any`</span>:
Any Catena instance with H = Blake2b and H&#39; = Blake2b-1
<span class="k">-</span> <span class="sb">`Any Full`</span>:
Any Catena instance with H = H&#39; = Blake2b
<span class="k">-</span> <span class="sb">`Butterfly`</span>
<span class="k">-</span> <span class="sb">`Butterfly Full`</span>
<span class="k">-</span> <span class="sb">`Butterfly Reduced`</span>:
Catena Butterfly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Butterfly Reduced Different G`</span>:
Catena Butterfly with <span class="sb">`g_low`</span> = 8 and <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Butterfly Full Reduced`</span>:
Catena Butterfly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Dragonfly`</span>
<span class="k">-</span> <span class="sb">`Dragonfly Full`</span>
<span class="k">-</span> <span class="sb">`Dragonfly Reduced`</span>:
Dragonfly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 14
<span class="k">-</span> <span class="sb">`Dragonfly Full Reduced`</span>:
Dragonfly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 14
<span class="k">-</span> <span class="sb">`Stonefly`</span>
<span class="k">-</span> <span class="sb">`Stonefly Full`</span>
<span class="k">-</span> <span class="sb">`Stonefly Reduced`</span>:
Stonefly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Stonefly Full Reduced`</span>:
Stonefly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Mydasfly`</span>:
<span class="k">-</span> <span class="sb">`Mydasfly Full`</span>:
<span class="k">-</span> <span class="sb">`Mydasfly Reduced`</span>:
Mydasfly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Mydasfly Full Reduced`</span>:
Mydasfly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Lanternfly`</span>
<span class="k">-</span> <span class="sb">`Lanternfly Full`</span>
<span class="k">-</span> <span class="sb">`Lanternfly Reduced`</span>
Lanternfly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Lanternfly Full Reduced`</span>:
Lanternfly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 9
<span class="k">-</span> <span class="sb">`Horsefly`</span>
<span class="k">-</span> <span class="sb">`Horsefly Full`</span>
<span class="k">-</span> <span class="sb">`Horsefly Reduced`</span>:
Horsefly with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 13
<span class="k">-</span> <span class="sb">`Horsefly Full Reduced`</span>:
Horsefly Full with <span class="sb">`g_low`</span> = <span class="sb">`g_high`</span> = 13

The purpose of the tests with the reduced Catena instances is to ensure that all
tests of all test vectors can run in acceptable time, even in the dynamically
typed languages.

Tests that do not need an instance of Catena have nothing appended to their
file names.

<span class="gu">## Blake2b</span>
Test files:
<span class="k">-</span> <span class="sb">`blake2b.json`</span>

<span class="gu">## Blake2b-1</span>
Test files:
<span class="k">-</span>  <span class="sb">`blake2b1.json`</span>

The tests are expected to run from first to last with the same instance of
Blake2b-1. The field <span class="sb">`reset`</span> indicates wether or not the <span class="sb">`reset`</span>
function of the Blake2b-1 instance has to be called before the test.

<span class="gu">## CF_Argon2</span>
Test files for the complete compression function:
<span class="k">-</span>  <span class="sb">`cfArgon2Gb.json`</span>
<span class="k">-</span>  <span class="sb">`cfArgon2Gl.json`</span>

Test files for G<span class="ge">_L and G_</span>B:
<span class="k">-</span>  <span class="sb">`gB.json`</span>
<span class="k">-</span>  <span class="sb">`gL.json`</span>

Test files for the $permute$ function:
<span class="k">-</span>  <span class="sb">`permuteGb.json`</span>
<span class="k">-</span>  <span class="sb">`permuteGl.json`</span>
<span class="k">-</span>  <span class="sb">`permuteGbHex.json`</span>
<span class="k">-</span>  <span class="sb">`permuteGlHex.json`</span>

The test files with the <span class="sb">`Hex`</span> suffix are the test cases as the respective
files without the suffix. The hex versions have the 64 bit integers encoded as
hex values for the JavaScript implementation because JavaScript has no built-in
64 bit integer type.

<span class="gu">## H_first</span>
Test files:
<span class="k">-</span>  <span class="sb">`hFirstAny.json`</span>

<span class="gu">## Bit-Reversal Graph</span>
Test files for index function:
<span class="k">-</span>  <span class="sb">`brgIndex.json`</span>

Test files for full graph:
<span class="k">-</span>  <span class="sb">`brgAny.json`</span>
<span class="k">-</span>  <span class="sb">`brgAnyFull.json`</span>

<span class="gu">## Shifted Bit-Reversal Graph</span>
Test files for index function:
<span class="k">-</span>  <span class="sb">`sbrgIndex.json`</span>

Test files for full graph:
<span class="k">-</span>  <span class="sb">`sbrgAny.json`</span>
<span class="k">-</span>  <span class="sb">`sbrgAnyFull.json`</span>

<span class="gu">## Gray-Reverse Graph</span>
Test files for index function:
<span class="k">-</span>  <span class="sb">`grgIndex.json`</span>

Test files for full graph:
<span class="k">-</span>  <span class="sb">`grgAny.json`</span>
<span class="k">-</span>  <span class="sb">`grgAnyFull.json`</span>

<span class="gu">## Double Butterfly Graph</span>
Test files for index function:
<span class="k">-</span>  <span class="sb">`dbhIndex.json`</span>

Test files for full graph:
<span class="k">-</span>  <span class="sb">`dbhAny.json`</span>
<span class="k">-</span>  <span class="sb">`dbhAnyFull.json`</span>

<span class="gu">## Saltmix</span>
Test files:
<span class="k">-</span>  <span class="sb">`saltmix.json`</span>

The input <span class="sb">`hash`</span> is the hashed salt, appended four times.

<span class="gu">## Phi</span>
Test file for the LSB index function:
<span class="k">-</span> <span class="sb">`lsbIndex.json`</span>

<span class="gu">## H_init</span>
Test files:
<span class="k">-</span> <span class="sb">`hInitAnyFull.json`</span>

The output tuple <span class="sb">`v`</span> is <span class="sb">`[v_-2, v_-1]`</span>.

<span class="gu">## Tweak</span>
Test files:
<span class="k">-</span> <span class="sb">`tweakButterfly.json`</span>
<span class="k">-</span> <span class="sb">`tweakButterflyFull.json`</span>
<span class="k">-</span> <span class="sb">`tweakDragonfly.json`</span>
<span class="k">-</span> <span class="sb">`tweakDragonflyFull.json`</span>

The field <span class="sb">`aData`</span> is an UTF-8 string.

<span class="gu">## Flap</span>
Test files:
<span class="k">-</span> <span class="sb">`flapButterfly.json`</span>
<span class="k">-</span> <span class="sb">`flapButterflyFull.json`</span>
<span class="k">-</span> <span class="sb">`flapDragonfly.json`</span>
<span class="k">-</span> <span class="sb">`flapDragonflyFull.json`</span>

<span class="gu">## Catena</span>
Test files:
<span class="k">-</span> <span class="sb">`catenaButterfly.json`</span>
<span class="k">-</span> <span class="sb">`catenaButterflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaButterflyFullReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaDragonfly.json`</span>
<span class="k">-</span> <span class="sb">`catenaDragonflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaDragonflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaDragonflyFullReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaHorsefly.json`</span>
<span class="k">-</span> <span class="sb">`catenaHorseflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaHorseflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaHorseflyFullReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaLanternfly.json`</span>
<span class="k">-</span> <span class="sb">`catenaLanternflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaLanternflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaLanternflyFullReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaMydasfly.json`</span>
<span class="k">-</span> <span class="sb">`catenaMydasflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaMydasflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaMydasflyFullReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaStonefly.json`</span>
<span class="k">-</span> <span class="sb">`catenaStoneflyFull.json`</span>
<span class="k">-</span> <span class="sb">`catenaStoneflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`catenaStoneflyFullReduced.json`</span>

The non-reduced tests implicitly test the correct parameters of the default
instances and variants.

<span class="gu">## Key Derivation</span>
Test files:
<span class="k">-</span> <span class="sb">`keyDerivationButterfly.json`</span>
<span class="k">-</span> <span class="sb">`keyDerivationButterflyFull.json`</span>
<span class="k">-</span> <span class="sb">`keyDerivationButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`keyDerivationDragonfly.json`</span>
<span class="k">-</span> <span class="sb">`keyDerivationDragonflyFull.json`</span>
<span class="k">-</span> <span class="sb">`keyDerivationDragonflyReduced.json`</span>

<span class="gu">## Keyed Hashing</span>
Test files:
<span class="k">-</span> <span class="sb">`keyedHashButterfly.json`</span>
<span class="k">-</span> <span class="sb">`keyedHashButterflyFull.json`</span>
<span class="k">-</span> <span class="sb">`keyedHashButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`keyedHashDragonfly.json`</span>
<span class="k">-</span> <span class="sb">`keyedHashDragonflyFull.json`</span>
<span class="k">-</span> <span class="sb">`keyedHashDragonflyReduced.json`</span>

<span class="gu">## Server Relief</span>
Test files for client side:
<span class="k">-</span> <span class="sb">`serverReliefServerButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`serverReliefServerButterflyReducedDifferentG.json`</span>
<span class="k">-</span> <span class="sb">`serverReliefServerDragonflyReduced.json`</span>
The test case <span class="sb">`serverReliefServerButterflyReducedDifferentG.json`</span> is
needed to test the loop in the server relief, which is skipped if <span class="sb">`g_low`</span> =
<span class="sb">`g_high`</span>.

Test files for server side:
<span class="k">-</span> <span class="sb">`serverReliefServerButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`serverReliefServerDragonflyReduced.json`</span>

<span class="gu">## Client-Independent Update</span>
Test files:
<span class="k">-</span> <span class="sb">`ciUpdateDragonflyReduced.json`</span>

<span class="gu">## Keyed Client-Independent Update</span>
Test files:
<span class="k">-</span> <span class="sb">`ciUpdateKeyedDragonflyReduced.json`</span>

<span class="gu">## Proof of Work</span>
Test files for the server side:
<span class="k">-</span> <span class="sb">`proofOfWorkServerPwdButterflyReduced.json`</span>
<span class="k">-</span> <span class="sb">`proofOfWorkServerSaltButterflyReduced.json`</span>

Test files for the client side:
<span class="k">-</span>  <span class="sb">`proofOfWorkClientPwdButterflyReduced.json`</span>
<span class="k">-</span>  <span class="sb">`proofOfWorkClientSaltButterflyReduced.json`</span>
</pre></div>
