<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">main.java.components.hash.algorithms</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">main.java.Helper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">main.java.components.hash.HashInterface</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Argon2CF</span> <span class="kd">implements</span> <span class="n">HashInterface</span> <span class="p">{</span>

    <span class="n">Helper</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Helper</span><span class="p">();</span>
    
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Argon2 hash function.&quot;</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">anzByte</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="c1">// use GL if 1 else use GB</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">_useGL</span><span class="p">;</span>
    
    <span class="kd">private</span> <span class="kt">long</span><span class="o">[]</span> <span class="n">_v</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">128</span><span class="o">]</span><span class="p">;</span>
    
    <span class="kd">private</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">_z</span><span class="p">;</span>
    
    <span class="kd">public</span> <span class="nf">Argon2CF</span> <span class="p">(</span><span class="kt">boolean</span> <span class="n">useGL</span><span class="p">){</span>
        <span class="n">_useGL</span> <span class="o">=</span> <span class="n">useGL</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">2048</span><span class="p">){</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">x</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">anzByte</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">y</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">anzByte</span><span class="o">]</span><span class="p">;</span>
        
        <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anzByte</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anzByte</span><span class="p">);</span>
        
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">R</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
        <span class="kt">byte</span> <span class="o">[]</span> <span class="n">Q</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">R</span><span class="p">.</span><span class="na">length</span><span class="o">]</span><span class="p">;</span>
        
        <span class="c1">// updating rows</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">128</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">384</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="mi">3</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="mi">4</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">768</span><span class="p">),</span> <span class="mi">5</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">768</span><span class="p">,</span> <span class="mi">896</span><span class="p">),</span> <span class="mi">6</span><span class="p">);</span>
        <span class="n">pWrapper</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">896</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">7</span><span class="p">);</span>
        
        
        <span class="c1">// inverting elements of array _v</span>
<span class="c1">//      for (int i = 0; i&lt;_v.length; ++i){</span>
<span class="c1">//          byte[] tmp = long2bytes(_v[i]);</span>
<span class="c1">//          </span>
<span class="c1">//          for (int k = 0; k &lt; tmp.length/2; k++) {</span>
<span class="c1">//              byte temp = tmp[k];</span>
<span class="c1">//              tmp[k] = tmp[tmp.length-(1+k)];</span>
<span class="c1">//              tmp[tmp.length-(1+k)] = temp;</span>
<span class="c1">//          }</span>
<span class="c1">//          _v[i] = bytes2long(tmp, 0);</span>
<span class="c1">//      }</span>
        
        <span class="c1">// updating columns</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">i0</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i1</span> <span class="o">=</span> <span class="n">i0</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">i1</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i3</span> <span class="o">=</span> <span class="n">i2</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i4</span> <span class="o">=</span> <span class="n">i3</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i5</span> <span class="o">=</span> <span class="n">i4</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i6</span> <span class="o">=</span> <span class="n">i5</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i7</span> <span class="o">=</span> <span class="n">i6</span><span class="o">+</span><span class="mi">16</span><span class="p">;</span>
            
            <span class="n">p</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">i4</span><span class="p">,</span> <span class="n">i5</span><span class="p">,</span> <span class="n">i6</span><span class="p">,</span> <span class="n">i7</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="c1">// inverting elements of array _v</span>
<span class="c1">//      for (int i = 0; i&lt;_v.length; ++i){</span>
<span class="c1">//          byte[] tmp = long2bytes(_v[i]);</span>
<span class="c1">//          </span>
<span class="c1">//          for (int k = 0; k &lt; tmp.length/2; k++) {</span>
<span class="c1">//              byte temp = tmp[k];</span>
<span class="c1">//              tmp[k] = tmp[tmp.length-(1+k)];</span>
<span class="c1">//              tmp[tmp.length-(1+k)] = temp;</span>
<span class="c1">//          }</span>
<span class="c1">//          _v[i] = bytes2long(tmp, 0);</span>
<span class="c1">//      }</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">_v</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">long2bytes</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
        <span class="p">}</span>
                
        <span class="n">_z</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Q</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">p</span><span class="p">(</span><span class="kt">int</span> <span class="n">i0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i4</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i5</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i6</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i7</span><span class="p">){</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">_useGL</span><span class="p">){</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span>   <span class="n">i2</span><span class="p">,</span>   <span class="n">i4</span><span class="p">,</span>   <span class="n">i6</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i4</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i6</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span>   <span class="n">i3</span><span class="p">,</span>   <span class="n">i5</span><span class="p">,</span>   <span class="n">i7</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i5</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i7</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span>   <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i5</span><span class="p">,</span>   <span class="n">i7</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span>   <span class="n">i5</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i6</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span>   <span class="n">i3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i4</span><span class="p">,</span>   <span class="n">i6</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GL</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span>   <span class="n">i4</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i7</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span>   <span class="n">i2</span><span class="p">,</span>   <span class="n">i4</span><span class="p">,</span>   <span class="n">i6</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i4</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i6</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span>   <span class="n">i3</span><span class="p">,</span>   <span class="n">i5</span><span class="p">,</span>   <span class="n">i7</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i5</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i7</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span>   <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i5</span><span class="p">,</span>   <span class="n">i7</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span>   <span class="n">i5</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i6</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span>   <span class="n">i3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i4</span><span class="p">,</span>   <span class="n">i6</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">GB</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span>   <span class="n">i4</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i7</span><span class="p">);</span>
        <span class="p">}</span>
        
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">pWrapper</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">vIn</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">){</span>
        <span class="n">pAndInit</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> 
                <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> 
                <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> 
                <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">112</span><span class="p">),</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">vIn</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> 
                <span class="n">idx</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">pAndInit</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p2</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p3</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p4</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p5</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p6</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p7</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">p8</span><span class="p">,</span>
            <span class="kt">int</span> <span class="n">idx</span><span class="p">){</span>
        
        <span class="c1">// initialize v (global array)</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">0</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">5</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        
        <span class="n">_v</span><span class="o">[</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">p8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
            
        <span class="k">if</span><span class="p">(</span><span class="n">_useGL</span><span class="p">){</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">5</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">5</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GL</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">5</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">5</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
            <span class="n">GB</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">),</span> <span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">idx</span><span class="o">*</span><span class="mi">16</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">doFinal</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">_z</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">GL</span><span class="p">(</span><span class="kt">int</span> <span class="n">posA</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posB</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posC</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posD</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span><span class="p">;</span>
        <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span><span class="p">;</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span> <span class="c1">// replaces 25 of BLAKE</span>
        <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span><span class="p">;</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span><span class="p">;</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">63</span><span class="p">);</span> <span class="c1">// replaces 11 of BLAKE</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">GB</span><span class="p">(</span><span class="kt">int</span> <span class="n">posA</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posB</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posC</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posD</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">+</span> 
                <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">)</span> 
                <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">);</span>
        <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">+</span> 
                <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">)</span> 
                <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span> <span class="c1">// replaces 25 of BLAKE</span>
        <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">+</span> 
                <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">)</span> 
                <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">+</span> 
                <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">)</span> 
                <span class="o">*</span> <span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0x00000000FFFFFFFFL</span><span class="p">);</span> 
        <span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">_v</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">_v</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">63</span><span class="p">);</span> <span class="c1">// replaces 11 of BLAKE</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">long</span> <span class="nf">rotr64</span><span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rot</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">rot</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">rot</span><span class="p">));</span>
    <span class="p">}</span>
    
    <span class="c1">// convert one long value in byte array</span>
    <span class="c1">// little-endian byte order!</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">long2bytes</span><span class="p">(</span><span class="kt">long</span> <span class="n">longValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="p">{</span>         
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="n">longValue</span><span class="p">,</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">48</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">56</span><span class="p">)};</span>
    <span class="p">}</span>
    
    <span class="c1">// little-endian byte order!</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">bytes2long</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">)</span> <span class="p">{</span>
          
        <span class="k">return</span> <span class="p">(</span>
                <span class="p">((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">2</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">3</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">4</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">5</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">40</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">6</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">48</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">7</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">56</span><span class="p">)</span> <span class="p">)</span> <span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">_v</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">128</span><span class="o">]</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">message</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVertexIndex</span><span class="p">(</span><span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getOutputSize</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">anzByte</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
