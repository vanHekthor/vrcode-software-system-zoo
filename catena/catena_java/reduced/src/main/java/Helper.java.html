<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">main.java</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.ByteBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.json.JSONArray</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Helper</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">hexArray</span> <span class="o">=</span> 
            <span class="s">&quot;0123456789ABCDEF&quot;</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>

    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * from &quot;github.com/Beloumi/Crypto-Eck&quot;</span>
<span class="cm">     * transfers string to byte array</span>
<span class="cm">     * @param  hexString    input string</span>
<span class="cm">     * @return              byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">hex2bytes</span><span class="o">(</span><span class="n">String</span> <span class="n">hexString</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// 2 Character = 1 Byte</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">hexString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">hexString</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span> <span class="o">(</span><span class="n">len</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="mi">1</span><span class="o">){</span> 
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Illegal Argument (Function &quot;</span>
                    <span class="o">+</span> <span class="s">&quot;hexStringToBytes): HexString is not even&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">final</span> <span class="kt">char</span> <span class="o">[]</span> <span class="n">hexCharArray</span> <span class="o">=</span> <span class="n">hexString</span><span class="o">.</span><span class="na">toCharArray</span> <span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hexString</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// 1. char in hex &lt;&lt;4, 2. char in hex</span>
            <span class="n">byteArray</span><span class="o">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="o">]</span> <span class="o">=</span> 
                    <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">Character</span><span class="o">.</span><span class="na">digit</span> <span class="o">(</span><span class="n">hexCharArray</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="mi">16</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="o">)</span> 
                    <span class="o">+</span> <span class="n">Character</span><span class="o">.</span><span class="na">digit</span> <span class="o">(</span><span class="n">hexCharArray</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">],</span> <span class="mi">16</span><span class="o">));</span>
        <span class="o">}</span>       
        <span class="k">return</span> <span class="n">byteArray</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">string2Bytes</span> <span class="o">(</span><span class="n">String</span> <span class="n">hexString</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">hexString</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * from &quot;github.com/Beloumi/Crypto-Eck&quot;</span>
<span class="cm">     * transfers byte array to string</span>
<span class="cm">     * @param bytes     array of bytes</span>
<span class="cm">     * @return          hexString</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="nf">bytes2hex</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">hexChars</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">bytes</span><span class="o">.</span><span class="na">length</span> <span class="o">*</span> <span class="mi">2</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">j</span><span class="o">++</span> <span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">bytes</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">;</span>
            <span class="n">hexChars</span><span class="o">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">hexArray</span><span class="o">[</span><span class="n">v</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span><span class="o">];</span>
            <span class="n">hexChars</span><span class="o">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">hexArray</span><span class="o">[</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">hexChars</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * Concatenation function to combine all elements of the</span>
<span class="cm">     * tweak in one array</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes1    vId </span>
<span class="cm">     * @param bytes2    mode</span>
<span class="cm">     * @param bytes3    lambda</span>
<span class="cm">     * @param bytes4    outLen</span>
<span class="cm">     * @param bytes5    sLen</span>
<span class="cm">     * @param bytes6    additionalData</span>
<span class="cm">     * </span>
<span class="cm">     * @return          all in one array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">concateByteArrays</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes1</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes2</span><span class="o">,</span> 
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes3</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes4</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes5</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes6</span><span class="o">){</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes1</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes2</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes3</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes4</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes5</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes6</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * Concatenation function to combine tweak array</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes1    t</span>
<span class="cm">     * @param bytes2    pwd</span>
<span class="cm">     * @param bytes3    salt</span>
<span class="cm">     * @return          all in one array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">concateByteArrays</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes1</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes2</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes3</span><span class="o">){</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes1</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes2</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes3</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * Concatenation function for byte arrays</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes1    byte[] 1</span>
<span class="cm">     * @param bytes2    byte[] 2</span>
<span class="cm">     * @param bytes3    byte[] 3</span>
<span class="cm">     * @param bytes4    byte[] 4</span>
<span class="cm">     * @return          all in one array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">concateByteArrays</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes1</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes2</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes3</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes4</span><span class="o">){</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes1</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes2</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes3</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes4</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * Concatenation function to combine 2 byte arrays</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes1    first array</span>
<span class="cm">     * @param bytes2    second array</span>
<span class="cm">     * @return          all in one array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">concateByteArrays</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes1</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes2</span><span class="o">){</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes1</span><span class="o">);</span>
            <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes2</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Converts Integer to byte arrays of size 2 or 4</span>
<span class="cm">     * </span>
<span class="cm">     * @param data      input integer</span>
<span class="cm">     * @param bytes     ammount of bytes in array</span>
<span class="cm">     * @return          converted byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">intToByteArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">data</span><span class="o">,</span> <span class="kt">int</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
    
        <span class="k">if</span> <span class="o">(</span><span class="n">bytes</span> <span class="o">==</span> <span class="mi">4</span><span class="o">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">];</span>
            
            <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0xFF000000</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x00FF0000</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x0000FF00</span><span class="o">)</span> <span class="o">&gt;&gt;</span>  <span class="mi">8</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x000000FF</span><span class="o">)</span>      <span class="o">);</span>
            
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">bytes</span> <span class="o">==</span> <span class="mi">2</span><span class="o">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
            
            <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="o">));</span>
            
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Converts Integer to byte arrays of size 2 or 4</span>
<span class="cm">     * </span>
<span class="cm">     * @param data      input integer</span>
<span class="cm">     * @param bytes     ammount of bytes in array</span>
<span class="cm">     * @return          converted byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">intToByteArrayLittleEndian</span><span class="o">(</span><span class="kt">int</span> <span class="n">data</span><span class="o">,</span> <span class="kt">int</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
    
        <span class="k">if</span> <span class="o">(</span><span class="n">bytes</span> <span class="o">==</span> <span class="mi">4</span><span class="o">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">];</span>
            
            <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x000000FF</span><span class="o">)</span>      <span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x0000FF00</span><span class="o">)</span> <span class="o">&gt;&gt;</span>  <span class="mi">8</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x00FF0000</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0xFF000000</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="o">);</span>
            
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">bytes</span> <span class="o">==</span> <span class="mi">2</span><span class="o">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
            
            <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="o">)</span>     <span class="o">);</span>
            <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="n">data</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">);</span>
            
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * combines two dimensional byte array to one dimension </span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes     two dim byte array</span>
<span class="cm">     * @return          one dimensional array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">twoDimByteArrayToOne</span><span class="o">(</span><span class="kt">byte</span><span class="o">[][]</span> <span class="n">bytes</span><span class="o">){</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="o">();</span>
        
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">row</span> <span class="o">=</span><span class="mi">0</span> <span class="o">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">row</span><span class="o">){</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes</span><span class="o">[</span><span class="n">row</span><span class="o">]);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[][]</span> <span class="nf">oneDimByteArrToTwoDim</span> <span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">len</span><span class="o">){</span>
        <span class="kt">int</span> <span class="n">bLen</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">dimension</span> <span class="o">=</span> <span class="n">bLen</span><span class="o">/</span><span class="n">len</span><span class="o">;</span>
        
        <span class="kt">byte</span><span class="o">[][]</span> <span class="n">twoDim</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">dimension</span><span class="o">][</span><span class="n">len</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bLen</span><span class="o">/</span><span class="n">len</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span> <span class="o">){</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">tmp</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">len</span><span class="o">];</span>
            <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">i</span><span class="o">*</span><span class="n">len</span><span class="o">,</span> <span class="n">tmp</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">len</span><span class="o">);</span>
            <span class="n">twoDim</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">twoDim</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * Creates a new array of desired size and copies the old one in </span>
<span class="cm">     * </span>
<span class="cm">     * @param b     input array of size m</span>
<span class="cm">     * @param l     desired size</span>
<span class="cm">     * @return      array with padded 0&#39;s</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">paddWithZero</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">l</span><span class="o">){</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">l</span><span class="o">];</span>
        <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">output</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">output</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Helper-function</span>
<span class="cm">     * truncates at the end of flap</span>
<span class="cm">     * </span>
<span class="cm">     * @param x     the current array to be truncated</span>
<span class="cm">     * @param m     the desired output length</span>
<span class="cm">     * @return      the resulting array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">truncate</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">m</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">m</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * XORing two byte arrays of equal size</span>
<span class="cm">     * </span>
<span class="cm">     * @param arr1      first byte array</span>
<span class="cm">     * @param arr2      second byte array</span>
<span class="cm">     * @return          XORed byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">xor</span> <span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">arr1</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">arr2</span><span class="o">){</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">arr1</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">arr1</span><span class="o">)</span>
            <span class="n">res</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">^</span> <span class="n">arr2</span><span class="o">[</span><span class="n">i</span><span class="o">++]);</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Container for byte to long and long to byte transformation</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="n">ByteBuffer</span> <span class="n">bufferLong</span> <span class="o">=</span> <span class="n">ByteBuffer</span><span class="o">.</span><span class="na">allocate</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">BYTES</span><span class="o">);</span>    

    <span class="cm">/**</span>
<span class="cm">     * Transforms long to byte array</span>
<span class="cm">     * </span>
<span class="cm">     * @param x     long input</span>
<span class="cm">     * @return      byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">longToBytes</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">bufferLong</span><span class="o">.</span><span class="na">putLong</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bufferLong</span><span class="o">.</span><span class="na">array</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Transforms byte arrsy to long</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes     bytes to transform to long</span>
<span class="cm">     * @return          long value</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">bytesToLong</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">bufferLong</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">bufferLong</span><span class="o">.</span><span class="na">flip</span><span class="o">();</span><span class="c1">//need flip </span>
        <span class="k">return</span> <span class="n">bufferLong</span><span class="o">.</span><span class="na">getLong</span><span class="o">();</span>
    <span class="o">}</span>
    

    <span class="cm">/**</span>
<span class="cm">     * Container for byte to int and int to byte transformation</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="n">ByteBuffer</span> <span class="n">bufferInt</span> <span class="o">=</span> <span class="n">ByteBuffer</span><span class="o">.</span><span class="na">allocate</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">BYTES</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Transforms Integer to byte array</span>
<span class="cm">     * </span>
<span class="cm">     * @param x         input integer</span>
<span class="cm">     * @return          byte array</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">intToBytes</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">bufferInt</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">bufferInt</span><span class="o">.</span><span class="na">putInt</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bufferInt</span><span class="o">.</span><span class="na">array</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Transforms byte array to Integer</span>
<span class="cm">     * </span>
<span class="cm">     * @param bytes     bytes to be transformed to int</span>
<span class="cm">     * @return          int value</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">bytesToInt</span> <span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">bufferInt</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bytes</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">bufferInt</span><span class="o">.</span><span class="na">flip</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">bufferInt</span><span class="o">.</span><span class="na">getInt</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="n">JSONArray</span> <span class="nf">jsonParserArr</span><span class="o">(</span><span class="n">File</span> <span class="n">f</span><span class="o">){</span>
        <span class="n">BufferedReader</span> <span class="n">br</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">all</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">f</span><span class="o">));</span>
            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">all</span><span class="o">+=</span><span class="n">line</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">JSONArray</span><span class="o">(</span><span class="n">all</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="n">JSONObject</span> <span class="nf">jsonParserObj</span><span class="o">(</span><span class="n">File</span> <span class="n">f</span><span class="o">){</span>
        <span class="n">BufferedReader</span> <span class="n">br</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">all</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">f</span><span class="o">));</span>
            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">all</span><span class="o">+=</span><span class="n">line</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">all</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
