<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">main.java.components.hash.algorithms</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Round-reduced Blake2b as H&#39; for Password Hashing Scheme Catena </span>
<span class="cm"> * Copyright (C) 2015  Axel von dem Bruch</span>
<span class="cm"> * </span>
<span class="cm"> * This library is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU Lesser General Public</span>
<span class="cm"> * License as published by the Free Software Foundation; either</span>
<span class="cm"> * version 2.1 of the License, or (at your option) any later version.</span>
<span class="cm"> * </span>
<span class="cm"> * This library is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * Lesser General Public License for more details.</span>
<span class="cm"> * </span>
<span class="cm"> * See:  https://www.gnu.org/licenses/lgpl-2.1.html</span>
<span class="cm"> * You should have received a copy of the GNU General Public License </span>
<span class="cm"> * along with this library.</span>
<span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">main.java.Helper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">main.java.components.hash.HashInterface</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Blake2b_1</span> <span class="kd">implements</span> <span class="n">HashInterface</span> <span class="p">{</span>
    
    <span class="n">Helper</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Helper</span><span class="p">();</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">blake2b_IV</span><span class="o">[]</span> <span class="o">=</span> 
            <span class="c1">// Blake2b Initialization Vector: </span>
            <span class="c1">// Produced from the square root of primes 2, 3, 5, 7, 11, 13, 17, 19.</span>
            <span class="c1">// The same as SHA-512 IV.</span>
        <span class="p">{</span>
          <span class="mh">0x6a09e667f3bcc908L</span><span class="p">,</span> <span class="mh">0xbb67ae8584caa73bL</span><span class="p">,</span> 
          <span class="mh">0x3c6ef372fe94f82bL</span><span class="p">,</span> <span class="mh">0xa54ff53a5f1d36f1L</span><span class="p">,</span>
          <span class="mh">0x510e527fade682d1L</span><span class="p">,</span> <span class="mh">0x9b05688c2b3e6c1fL</span><span class="p">,</span>
          <span class="mh">0x1f83d9abfb41bd6bL</span><span class="p">,</span> <span class="mh">0x5be0cd19137e2179L</span> 
        <span class="p">};</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">blake2b_IV0</span> <span class="o">=</span> <span class="mh">0x6a09e667f2bdc948L</span><span class="p">;</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[][]</span> <span class="n">blake2b_sigma</span> <span class="o">=</span> <span class="c1">// Message word permutations</span>
        <span class="p">{</span>
          <span class="p">{</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">4</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>  <span class="mi">8</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">5</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span> <span class="p">}</span> <span class="p">,</span>
          <span class="p">{</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span> <span class="p">}</span>
        <span class="p">};</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">BLOCK_LENGTH_BYTES</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span><span class="c1">// bytes</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">H_LEN</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span> 

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">vIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// used as vertex index for Catena</span>

    <span class="kd">private</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span><span class="c1">//new byte[BLOCK_LENGTH_BYTES];</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">halfBuffer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">long</span><span class="o">[]</span> <span class="n">internalState</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">16</span><span class="o">]</span><span class="p">;</span> <span class="c1">// In the Blake2b paper it is called: v</span>
    <span class="kd">private</span> <span class="kt">long</span><span class="o">[]</span> <span class="n">chainValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// state vector, in the Blake2b paper it is called: h</span>
    
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span><span class="n">L</span><span class="p">;</span> <span class="c1">// holds last significant bits, counter (counts bytes)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span><span class="n">L</span><span class="p">;</span> <span class="c1">// counter: Length up to 2^128 are supported</span>
    
    <span class="kd">public</span> <span class="nf">Blake2b_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">BLOCK_LENGTH_BYTES</span><span class="o">]</span><span class="p">;</span>
        <span class="n">init</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// initialize chainValue</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">chainValue</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
            <span class="n">chainValue</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span><span class="p">;</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV0</span><span class="p">;</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>      
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>          
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>          
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="p">;</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initializeInternalState</span><span class="p">(){</span>
        
        <span class="c1">// initialize v:</span>
        <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">chainValue</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">internalState</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">chainValue</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">blake2b_IV</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">internalState</span><span class="p">,</span> <span class="n">chainValue</span><span class="p">.</span><span class="na">length</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="n">internalState</span><span class="o">[</span><span class="mi">12</span><span class="o">]</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">^</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
        <span class="n">internalState</span><span class="o">[</span><span class="mi">13</span><span class="o">]</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">^</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
        <span class="n">internalState</span><span class="o">[</span><span class="mi">14</span><span class="o">]</span> <span class="o">=</span> <span class="mh">0xFFFFFFFFFFFFFFFFL</span> <span class="o">^</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="p">;</span>
        <span class="n">internalState</span><span class="o">[</span><span class="mi">15</span><span class="o">]</span> <span class="o">=</span> <span class="n">blake2b_IV</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Processes the given message</span>
<span class="cm">     * </span>
<span class="cm">     * @param message</span>
<span class="cm">     *            byte array containing the message to be processed</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//      System.out.println(&quot;B2B1 mess.l: &quot; + message.length);</span>
<span class="c1">//      System.out.println(&quot;input b2b1: &quot; + helper.bytes2hex(message));</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">128</span><span class="p">){</span>
            <span class="n">update</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">);</span>
            <span class="n">update</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="na">copyOfRange</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">update</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Processes one single byte</span>
<span class="cm">     * </span>
<span class="cm">     * @param b</span>
<span class="cm">     *            single byte to be processed</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span> <span class="n">b</span><span class="p">)</span> <span class="p">{}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Processes a number of bytes of the given message </span>
<span class="cm">     * from a start position up to offset+len</span>
<span class="cm">     * </span>
<span class="cm">     * @param message</span>
<span class="cm">     *            byte array containing the message to be processed</span>
<span class="cm">     * @param offset</span>
<span class="cm">     *            position of message to start from</span>
<span class="cm">     * @param len</span>
<span class="cm">     *            number of bytes to be processed.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">message</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">halfBuffer</span><span class="p">){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span>  <span class="n">offset</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">);</span>
            <span class="n">halfBuffer</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>          
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span>  <span class="n">offset</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">,</span> <span class="n">H_LEN</span><span class="p">);</span>           
            <span class="n">halfBuffer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Calculates the final digest value atus</span>
<span class="cm">     */</span> 
    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">doFinal</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">H_LEN</span><span class="o">]</span><span class="p">;</span>
        <span class="n">t0</span> <span class="o">+=</span> <span class="n">BLOCK_LENGTH_BYTES</span><span class="p">;</span>
        <span class="c1">// simplified because increment is always 128</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">t0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)){</span>
            <span class="n">t1</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
<span class="c1">//      Helper h = new Helper();</span>
<span class="c1">//      System.out.println(&quot;Buffer: &quot; + h.bytes2hex(buffer));</span>
        
        <span class="n">compress</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">halfBuffer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        
        <span class="c1">// increment counter by one</span>
        <span class="n">vIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">vIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">12</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">chainValue</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">long2bytes</span><span class="p">(</span><span class="n">chainValue</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Reset the hash function to use again after doFinal().</span>
<span class="cm">     * This will not work for keyed digests. </span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">//      System.out.println(&quot;--- RESET B2B1---&quot;);</span>
        <span class="n">halfBuffer</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span><span class="n">L</span><span class="p">;</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span><span class="n">L</span><span class="p">;</span>
        <span class="n">Arrays</span><span class="p">.</span><span class="na">fill</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span>  <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">Arrays</span><span class="p">.</span><span class="na">fill</span><span class="p">(</span><span class="n">chainValue</span><span class="p">,</span> <span class="mi">0</span><span class="n">L</span><span class="p">);</span>    
        <span class="n">Arrays</span><span class="p">.</span><span class="na">fill</span><span class="p">(</span><span class="n">internalState</span><span class="p">,</span> <span class="mi">0</span><span class="n">L</span><span class="p">);</span>
        <span class="n">chainValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        
        <span class="n">vIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        
        <span class="n">init</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">compress</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">message</span><span class="p">,</span> <span class="kt">int</span> <span class="n">messagePos</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">initializeInternalState</span><span class="p">();</span>
        
        <span class="kt">long</span><span class="o">[]</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">16</span><span class="o">]</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">m</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">bytes2long</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">messagePos</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="mi">8</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// single round: Catenas H&#39;</span>
        <span class="c1">// G apply to columns of internalState:m[blake2b_sigma[round][2 * blockPos]] /+1</span>
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">0</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">1</span><span class="o">]]</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">2</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">3</span><span class="o">]]</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">4</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">5</span><span class="o">]]</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">6</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">7</span><span class="o">]]</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">);</span> 
        <span class="c1">// G apply to diagonals of internalState:</span>
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">8</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">9</span><span class="o">]]</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">10</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">11</span><span class="o">]]</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">12</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">13</span><span class="o">]]</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span> 
        <span class="n">G</span><span class="p">(</span><span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">14</span><span class="o">]]</span><span class="p">,</span> <span class="n">m</span><span class="o">[</span><span class="n">blake2b_sigma</span><span class="o">[</span><span class="n">vIndex</span><span class="o">][</span><span class="mi">15</span><span class="o">]]</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span> 
        
        <span class="c1">// update chain values: </span>
        <span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">offset</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">chainValue</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span> <span class="o">=</span> <span class="n">chainValue</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">8</span><span class="o">]</span><span class="p">;</span>    
        <span class="p">}</span>
    <span class="p">}</span>
    

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">G</span><span class="p">(</span><span class="kt">long</span> <span class="n">m1</span><span class="p">,</span> <span class="kt">long</span> <span class="n">m2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posA</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posB</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posC</span><span class="p">,</span> <span class="kt">int</span> <span class="n">posD</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">+</span> <span class="n">m1</span><span class="p">;</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span><span class="p">;</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span> <span class="c1">// replaces 25 of BLAKE</span>
        <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">=</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span> <span class="o">+</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">+</span> <span class="n">m2</span><span class="p">;</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posA</span><span class="o">]</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">=</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span> <span class="o">+</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posD</span><span class="o">]</span><span class="p">;</span> 
        <span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">=</span> <span class="n">rotr64</span><span class="p">(</span><span class="n">internalState</span><span class="o">[</span><span class="n">posB</span><span class="o">]</span> <span class="o">^</span> <span class="n">internalState</span><span class="o">[</span><span class="n">posC</span><span class="o">]</span><span class="p">,</span> <span class="mi">63</span><span class="p">);</span> <span class="c1">// replaces 11 of BLAKE</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kt">long</span> <span class="nf">rotr64</span><span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rot</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">rot</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">rot</span><span class="p">));</span>
    <span class="p">}</span>
    

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">(){</span>
        <span class="k">return</span> <span class="s">&quot;Catena_Blake2b_1&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cm">/**</span>
<span class="cm">     * This function is used for password hashing scheme</span>
<span class="cm">     * Catenas round-reduced version H&#39;</span>
<span class="cm">     * </span>
<span class="cm">     * @param _vIndex   some index</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVertexIndex</span><span class="p">(</span><span class="kt">int</span> <span class="n">_vIndex</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="n">vIndex</span> <span class="o">=</span> <span class="n">_vIndex</span> <span class="o">%</span> <span class="mi">12</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// convert one long value in byte array</span>
    <span class="c1">// little-endian byte order!</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">long2bytes</span><span class="p">(</span><span class="kt">long</span> <span class="n">longValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="p">{</span>         
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="n">longValue</span><span class="p">,</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">48</span><span class="p">),</span>
            <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">longValue</span> <span class="o">&gt;&gt;</span> <span class="mi">56</span><span class="p">)};</span>
    <span class="p">}</span>
    <span class="c1">// little-endian byte order!</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">bytes2long</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">)</span> <span class="p">{</span>
          
          <span class="k">return</span> <span class="p">(</span>                
                  <span class="p">((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">2</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">3</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">4</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">5</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">40</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">6</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">48</span><span class="p">)</span> <span class="o">|</span>
                  <span class="p">(((</span><span class="kt">long</span><span class="p">)</span> <span class="n">byteArray</span><span class="o">[</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">7</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">56</span><span class="p">)</span> <span class="p">)</span> <span class="p">;</span>                                  
    <span class="p">}</span>


    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getOutputSize</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">H_LEN</span><span class="p">;</span>
    <span class="p">}</span>   
<span class="p">}</span>
</pre></div>
